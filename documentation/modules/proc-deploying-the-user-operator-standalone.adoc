// Module included in the following assemblies:
//
// assembly-user-operator.adoc

[id='proc-deploying-the-user-operator-standalone-{context}']
= Deploying the standalone User Operator

Deploying the User Operator as a standalone component is more complicated than installing it using the Cluster Operator, but it is more flexible.
For instance, it can operate _with_ any Kafka cluster, not only the one deployed by the Cluster Operator.

.Prerequisites

* An existing Kafka cluster for the User Operator to connect to.

.Procedure

. Edit the `install/user-operator/05-Deployment-strimzi-user-operator.yaml` resource. You will need to change the following
+
.. The `STRIMZI_CA_CERT_NAME` environment variable in `Deployment.spec.template.spec.containers[0].env` should be set to point to a Kubernetes `Secret` which should contain the public key of the Certificate Authority for signing new user certificates for TLS Client Authentication.
The `Secret` should contain the public key of the Certificate Authority under the key `ca.crt`.
.. The `STRIMZI_CA_KEY_NAME` environment variable in `Deployment.spec.template.spec.containers[0].env` should be set to point to a Kubernetes `Secret` which should contain the private key of the Certificate Authority for signing new user certificates for TLS Client Authentication.
The `Secret` should contain the private key of the Certificate Authority under the key `ca.key`.
.. The `STRIMZI_ZOOKEEPER_CONNECT` environment variable in `Deployment.spec.template.spec.containers[0].env` should be set to a list of the ZooKeeper nodes, given as a comma-separated list of `_hostname_:‍_port_` pairs. This should be the same ZooKeeper cluster that your Kafka cluster is using.
.. The `STRIMZI_NAMESPACE` environment variable in `Deployment.spec.template.spec.containers[0].env` should be set to the Kubernetes namespace in which you want the operator to watch for  `KafkaUser` resources.
.. The `STRIMZI_JAVA_OPTS` environment variable in `Deployment.spec.template.spec.containers[0].env` should be set to the Java options used for the JVM running User Operator. An example is `-Xmx=512M -Xms=256M`.
.. The `STRIMZI_JAVA_SYSTEM_PROPERTIES` environment variable in `Deployment.spec.template.spec.containers[0].env` should be set to the list of `-D` options which are set to the User Operator. An example is `-Djavax.net.debug=verbose -DpropertyName=value`.
.. The `STRIMZI_KAFKA_BOOTSTRAP_SERVERS` environment variable in `Deployment.spec.template.spec.containers[0].env` should be set to a list of the Kafka brokers, given as a comma-separated list of `_hostname_:‍_port_` pairs.
.. The `STRIMZI_CLUSTER_CA_CERT_SECRET_NAME` environment variable in `Deployment.spec.template.spec.containers[0].env` should be set to point to a Kubernetes `Secret` which should contain the public key of the Certificate Authority used for signing Kafka brokers certificates for enabling TLS based communication.
The `Secret` should contain the public key of the Certificate Authority under the key `ca.crt`.
This environment variable is optional and should be set only if the communication with the Kafka cluster is TLS based.
.. The `STRIMZI_EO_KEY_SECRET_NAME` environment variable in `Deployment.spec.template.spec.containers[0].env` should be set to point to a Kubernetes `Secret` which should contain the private key and related certificate for TLS Client Authentication against the Kafka cluster.
The `Secret` should contain the keystore with the private key and certificate under the key `entity-operator.p12` and the related password under the key `entity-operator.password`.
This environment variable is optional and should be set if the TLS Client Authentication is needed when the communication with the Kafka cluster is TLS based.

. Deploy the User Operator.
+
This can be done using `kubectl apply`:
+
[source,shell,subs=+quotes]
kubectl apply -f install/user-operator

. Verify that the User Operator has been deployed successfully.
This can be done using `kubectl describe`:
+
[source,shell,subs=+quotes]
kubectl describe deployment strimzi-user-operator
+
The User Operator is deployed once the `Replicas:` entry shows `1 available`.
+
NOTE: This could take some time if you have a slow connection to the Kubernetes and the images have not been downloaded before.

.Additional resources

* For more information about getting the Cluster Operator to deploy the User Operator for you, see xref:proc-deploying-the-user-operator-using-the-cluster-operator-str[].
