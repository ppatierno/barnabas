// Module included in the following assemblies:
//
// assembly-using-kafka-connect-with-plugins.adoc

[id='creating-new-image-from-base-{context}']
= Creating a Docker image from the Kafka Connect base image

A container image for running Kafka Connect using {ProductName} is available on {DockerRepository} as `{DockerKafkaConnect}`. You can use this as a base image for creating your own custom image with additional plug-ins. 

At startup, Kafka Connect loads any third-party plug-ins, including connectors, contained in the `/opt/kafka/plugins` directory. This procedure describes how to create a custom image and add your connector to this directory. 


.Prerequisites

ifdef::Kubernetes[]
* xref:deploying-cluster-operator-kubernetes-str[Deploying the Cluster Operator to {KubernetesName}]
endif::Kubernetes[]

* xref:deploying-cluster-operator-openshift-str[Deploying the Cluster Operator to {OpenShiftName}]

.Procedure

. Create a new `Dockerfile` using `{DockerKafkaConnect}` as the base image:
+
[source,subs="+quotes,attributes"]
----
FROM {DockerKafkaConnect}
USER root:root
COPY ./_my-plugins_/ /opt/kafka/plugins/
USER {DockerImageUser}
----

. Build the container image.

. Upload your custom image to the appropriate container image repository.

. Perform one of the following tasks:

* Edit the `KafkaConnect.spec.image` property of the `KafkaConnect` custom resource to point to the new container image.

* Edit the `STRIMZI_DEFAULT_KAFKA_CONNECT_IMAGE` variable to point to the new container image.

.Additional resources
* For more information on the `STRIMZI_DEFAULT_KAFKA_CONNECT_IMAGE` variable, see xref:ref-operators-cluster-operator-configuration-deploying-co[].
* For more information on the `KafkaConnect.spec.image property`, see xref:assembly-configuring-container-images-deployment-configuration-kafka-connect[].
