// Module included in the following assemblies:
//
// <List assemblies here, each on a new line>

// Base the file name and the ID on the module title. For example:
// * file name: assembly-cluster-operator.adoc
// * ID: [id='cluster-operator-{context}']
// * Title: = Configure Cluster Operator

// The ID is used as an anchor for linking to the module. Avoid changing it after the module has been published to ensure existing links are not broken.

include::common/attributes.adoc[]

[id='use-service-account-{context}']
= Using a ServiceAccount

The `Deployment` of the operator needs to specify the `ServiceAccoung`. The Cluster Operator is best run using a `ServiceAccount`:

.Prerequisites

//Add prerequisites if any

.Procedure

//Add a procedure for defining clusterroles


[source,yaml,options="nowrap"]
.Example `ServiceAccount` for the Cluster Operator
----
include::examples/install/cluster-operator/01-ServiceAccount-strimzi-cluster-operator.yaml[]
----

The `Deployment` of the operator then needs to specify this in its `spec.template.spec.serviceAccountName`:

[source,yaml,numbered,options="nowrap",highlight='12']
.Partial example `Deployment` for the Cluster Operator
----
include::examples/install/cluster-operator/05-Deployment-strimzi-cluster-operator.yaml[lines=1..13]
      # ...
----

Note line 12, where the `strimzi-cluster-operator` `ServiceAccount` is specified as the `serviceAccountName`.

Although the operator reacts to all notifications about the desired cluster resources received from the OpenShift or Kubernetes cluster, if the operator is not running, or if a notification is not received for any reason, the desired resources will get out of sync with the state of the running OpenShift or Kubernetes cluster.

In order to handle failovers properly, a periodic reconciliation process is executed by the Cluster Operator to compare the state of the desired resources with the current cluster deployments and have a consistent state across all of them.
